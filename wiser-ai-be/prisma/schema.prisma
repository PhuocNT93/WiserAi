generator client {
  provider = "prisma-client"
  output   = "../src/generated/client"
}

datasource db {
  provider = "postgresql"
}

enum Role {
  MEMBER
  MANAGER
  HR
  ADMIN
}

enum Position {
  DEV
  QC
  BA
}

enum Level {
  Fresher
  Junior
  Senior
  Master
}

model User {
  id        Int      @id @default(autoincrement())
  email     String   @unique
  password  String
  name      String?
  roles     Role[]   @default([MEMBER])
  
  skills    UserSkill[]
  refreshTokens RefreshToken[]
  courses   Course[] 
  
  managerId Int?
  manager   User?    @relation("UserManagement", fields: [managerId], references: [id])
  subordinates User[] @relation("UserManagement")

  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  @@map("users")
}

model RefreshToken {
  id        Int      @id @default(autoincrement())
  token     String   @unique 
  userId    Int
  user      User     @relation(fields: [userId], references: [id], onDelete: Cascade)
  revoked   Boolean  @default(false)
  expiresAt DateTime
  
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  @@map("refresh_tokens")
}

model UserSkill {
  id          Int      @id @default(autoincrement())
  userId      Int
  user        User     @relation(fields: [userId], references: [id], onDelete: Cascade)
  
  skillName   String
  experience  String?  
  level       String?  
  careerGoal  String?  

  createdAt   DateTime @default(now())
  updatedAt   DateTime @updatedAt

  @@map("user_skills")
}

model ConfigData {
  id          Int      @id @default(autoincrement())
  name        String   @unique
  value       String   
  
  createdAt   DateTime @default(now())
  updatedAt   DateTime @updatedAt

  @@map("config_data")
}

model Course {
  id          Int      @id @default(autoincrement())
  name        String
  description String?
  category    String?
  imageUrl    String?
  authorId    Int?
  author      User?    @relation(fields: [authorId], references: [id])
  
  createdAt   DateTime @default(now())
  updatedAt   DateTime @updatedAt

  @@map("courses")
}

// Master Data - Dat
model RoleSkillMapping {
  id          Int      @id @default(autoincrement())
  position    String
  code        String   @unique
  name        String
  level       String
  description String?
  
  createdAt   DateTime @default(now())
  updatedAt   DateTime @updatedAt

  @@map("role_skill_mapping")
}
model EmployeeProfile {
  id             Int      @id @default(autoincrement())
  userEmail      String
  engName        String
  empCode        String   @unique
  busUnit        String
  jobTitle       String
  
  createdAt   DateTime @default(now())
  updatedAt   DateTime @updatedAt

  @@map("employee_profile_mapping")
}